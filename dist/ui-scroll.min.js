/*!
 * angular-ui-scroll
 * https://github.com/angular-ui/ui-scroll.git
 * Version: 1.4.1 -- 2016-05-09T16:49:23.122Z
 * License: MIT
 */
!function(){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};angular.module("ui.scroll",[]).directive("uiScrollViewport",function(){return{controller:["$log","$scope","$element",function(a,b,c){var d=this;d.container=c,d.viewport=c,angular.forEach(c.children(),function(a){"tbody"===a.tagName.toLowerCase()&&(d.viewport=angular.element(a))})}]}}).directive("uiScroll",["$log","$injector","$rootScope","$timeout","$q","$parse",function(b,c,d,e,f,g){function h(a,b){return b.after(a),[]}function i(a){return a.element.remove(),a.scope.$destroy(),[]}function j(b,c){if(!p)return h(b,c);if(q){var d=function(){var a=f.defer();return p.enter(b,null,c,function(){return a.resolve()}),{v:[a.promise]}}();if("object"===("undefined"==typeof d?"undefined":a(d)))return d.v}return[p.enter(b,null,c)]}function k(b){if(!p)return i(b);if(q){var c=function(){var a=f.defer();return p.leave(b.element,function(){return b.scope.$destroy(),a.resolve()}),{v:[a.promise]}}();if("object"===("undefined"==typeof c?"undefined":a(c)))return c.v}return[p.leave(b.element).then(function(){return b.scope.$destroy()})]}function l(a){var b=Object.create(Array.prototype);return angular.extend(b,{size:a,reset:function(a){b.remove(0,b.length),b.eof=!1,b.bof=!1,b.first=a,b.next=a,b.minIndex=a,b.maxIndex=a,b.minIndexUser=null,b.maxIndexUser=null},append:function(a){a.forEach(function(a){++b.next,b.insert("append",a)})},prepend:function(a){a.reverse().forEach(function(a){--b.first,b.insert("prepend",a)})},insert:function(a,c){var d={item:c};if(a%1===0)d.op="insert",b.splice(a,0,d);else switch(d.op=a,a){case"append":b.push(d);break;case"prepend":b.unshift(d)}},remove:function(a,c){if(angular.isNumber(a)){for(var d=a;c>d;d++)i(b[d]);return b.splice(a,c-a)}return b.splice(b.indexOf(a),1),k(a)},setUpper:function(){b.maxIndex=b.eof?b.next-1:Math.max(b.next-1,b.maxIndex)},setLower:function(){b.minIndex=b.bof?b.minIndex=b.first:Math.min(b.first,b.minIndex)},effectiveHeight:function(a){if(!a.length)return 0;var b=Number.MAX_VALUE,c=Number.MIN_VALUE;return a.forEach(function(a){a.element[0].offsetParent&&(b=Math.min(b,a.element.offset().top),c=Math.max(c,a.element.offset().top+a.element.outerHeight(!0)))}),Math.max(0,c-b)}}),b}function m(a,b,c,d){function e(){var a=Object.create(Array.prototype);return angular.extend(a,{add:function(b){var c=a.find(function(a){return a.index===b.scope.$index});return c?void(c.height=b.element.outerHeight()):void a.push({index:b.scope.$index,height:b.element.outerHeight()})},clear:function(){a.length=0}}),a}function f(a){var b=void 0;switch(a.tagName){case"dl":throw new Error("ui-scroll directive does not support <"+a.tagName+"> as a repeating tag: "+a.outerHTML);case"tr":var c=angular.element("<table><tr><td><div></div></td></tr></table>");b=c.find("tr");break;case"li":b=angular.element("<li></li>");break;default:b=angular.element("<div></div>")}return b.cache=new e,b}function g(){return n.outerHeight()*Math.max(i,+d.padding||k)}var i=.3,k=.5,l=void 0,m=void 0,n=c&&c.viewport?c.viewport:angular.element(window),o=c&&c.container?c.container:void 0;return n.css({"overflow-y":"auto",display:"block"}),angular.extend(n,{createPaddingElements:function(a){l=new f(a),m=new f(a),b.before(l),b.after(m)},applyContainerStyle:function(){o&&o!==n&&n.css("height",window.getComputedStyle(o[0]).height)},bottomDataPos:function(){var a=n[0].scrollHeight;return a=null!=a?a:n[0].document.documentElement.scrollHeight,a-m.height()},topDataPos:function(){return l.height()},bottomVisiblePos:function(){return n.scrollTop()+n.outerHeight()},topVisiblePos:function(){return n.scrollTop()},insertElement:function(a,b){return h(a,b||l)},insertElementAnimated:function(a,b){return j(a,b||l)},shouldLoadBottom:function(){return!a.eof&&n.bottomDataPos()<n.bottomVisiblePos()+g()},clipBottom:function(){for(var b=0,c=0,d=0,e=n.bottomDataPos()-n.bottomVisiblePos()-g(),f=a.length-1;f>=0&&(d=a[f].element.outerHeight(!0),!(c+d>e));f--)m.cache.add(a[f]),c+=d,b++;b>0&&(a.eof=!1,a.remove(a.length-b,a.length),a.next-=b,n.adjustPadding())},shouldLoadTop:function(){return!a.bof&&n.topDataPos()>n.topVisiblePos()-g()},clipTop:function(){for(var b=0,c=0,d=0,e=n.topVisiblePos()-n.topDataPos()-g(),f=0;f<a.length&&(d=a[f].element.outerHeight(!0),!(c+d>e));f++)l.cache.add(a[f]),c+=d,b++;b>0&&(l.height(l.height()+c),a.bof=!1,a.remove(0,b),a.first+=b)},adjustPadding:function(b){if(a.length){var c=l.cache.reduce(function(b,c){return b+(c.index<a.first?c.height:0)},0),d=m.cache.reduce(function(b,c){return b+(c.index>=a.next?c.height:0)},0),e=0,f=0,g=a.minIndexUser&&a.minIndex>a.minIndexUser,h=a.maxIndexUser&&a.maxIndex<a.maxIndexUser;if(g||h){var i=a.reduce(function(a,b){return a+b.element.outerHeight(!0)},0),j=(i+c+d)/(a.maxIndex-a.minIndex+1);e=g?(a.minIndex-a.minIndexUser)*j:0,f=h?(a.maxIndexUser-a.maxIndex)*j:0}var k=l.height();if(l.height(c+e),m.height(d+f),b&&g&&e){var o=l.height()-k;n.scrollTop(n.scrollTop()+o)}}},adjustScrollTopAfterPrepend:function(a){var b=l.height()-a;b>=0?l.height(b):(l.height(0),n.scrollTop(n.scrollTop()-b))},resetTopPadding:function(){l.height(0),l.cache.clear()},resetBottomPadding:function(){m.height(0),m.cache.clear()}}),n}function n(a,b,c,e){function f(a,b){if(angular.isArray(b)){var d=void 0,e=c.indexOf(a)+1;b.reverse().forEach(function(b){b===a.item?(d=!0,e--):c.insert(e,b)}),d||(a.op="remove")}}var h=b.scope()||d,i=a.topVisible?g(a.topVisible).assign:angular.noop,j=a.topVisibleElement?g(a.topVisibleElement).assign:angular.noop,k=a.topVisibleScope?g(a.topVisibleScope).assign:angular.noop,l=a.isLoading?g(a.isLoading).assign:angular.noop,m=!1;Object.defineProperty(this,"disabled",{get:function(){return m},set:function(a){m=a,e()}}),this.isLoading=!1,this.applyUpdates=function(a,b){if(angular.isFunction(a))c.slice(0).forEach(function(b){f(b,a(b.item,b.scope,b.element))});else{if(a%1!==0)throw new Error("applyUpdates - "+a+" is not a valid index");var d=a-c.first;d>=0&&d<c.length&&f(c[d],b)}e()},this.append=function(a){c.append(a),e()},this.prepend=function(a){c.prepend(a),e()},this.loading=function(a){this.isLoading=a,l(h,a)},this.calculateProperties=function(){var a=void 0,d=void 0,e=void 0,f=void 0,g=void 0,l=void 0,m=0;for(a=0;a<c.length;a++){if(d=c[a],f=d.element.offset().top,g=l!==f,l=f,g&&(e=d.element.outerHeight(!0)),!(g&&b.topDataPos()+m+e<=b.topVisiblePos())){g&&(this.topVisible=d.item,this.topVisibleElement=d.element,this.topVisibleScope=d.scope,i(h,d.item),j(h,d.element),k(h,d.scope));break}m+=e}}}function o(a,b,h,i,j){function k(a,b,c){var d=Object.getOwnPropertyDescriptor(a,b);d&&(d.set||d.get)||Object.defineProperty(a,b,{set:function(a){this["_"+b]=a,e(function(){M[c]=a,L.length||N.adjustPadding("minIndex"===b)})},get:function(){return this["_"+b]}})}function o(){N.bind("resize",B),N.bind("scroll",B)}function p(){N.unbind("resize",B),N.unbind("scroll",B)}function q(){N.resetTopPadding(),N.resetBottomPadding(),arguments.length&&(J=arguments[0]),M.reset(J),y()}function r(a){return a.element.height()&&a.element[0].offsetParent}function s(a){r(a)&&(M.forEach(function(a){angular.isFunction(a.unregisterVisibilityWatcher)&&(a.unregisterVisibilityWatcher(),delete a.unregisterVisibilityWatcher)}),y())}function t(a,b){return u(a,b,N.insertElement),r(a)?!0:(a.unregisterVisibilityWatcher=a.scope.$watch(function(){return s(a)}),!1)}function u(a,b,c){var d,e=b>0?M[b-1].element:void 0;return j(function(b,f){d=c(b,e),a.element=b,a.scope=f,f[F]=a.item}),d}function v(){var a=[],b=[],c=[],d=[];M.forEach(function(e,f){switch(e.op){case"prepend":b.unshift(e);break;case"append":t(e,f),e.op="none",d.push(e);break;case"insert":a=a.concat(u(e,f,N.insertElementAnimated)),e.op="none",d.push(e);break;case"remove":c.push(e)}}),c.forEach(function(b){return a=a.concat(M.remove(b))}),b.length&&b.forEach(function(a){t(a),a.op="none"}),M.forEach(function(a,b){return a.scope.$index=M.first+b});var e=M.effectiveHeight(b);return N.adjustScrollTopAfterPrepend(e),{estimatedPaddingIncrement:e,prepended:b,removed:c,inserted:d,animated:a}}function w(a,b){var c=M.effectiveHeight(b.prepended)-b.estimatedPaddingIncrement;return N.adjustScrollTopAfterPrepend(c),b.animated.length?f.all(b.animated).then(function(){N.adjustPadding(),y(a)}):N.adjustPadding(),c+b.estimatedPaddingIncrement>0||M.effectiveHeight(b.inserted)>0}function x(a,b){N.shouldLoadBottom()&&b?1===L.push(!0)&&(A(a),O.loading(!0)):N.shouldLoadTop()&&(b||L[0])&&1===L.push(!1)&&(A(a),O.loading(!0))}function y(a){a||(L=[],a=++K);var b=v();e(function(){w(a,b),x(a,!0),L.length||O.calculateProperties()})}function z(a){var b=v();e(function(){x(a,w(a,b)),L.shift(),L.length?A(a):(O.loading(!1),o(),O.calculateProperties())})}function A(b){L[0]?M.length&&!N.shouldLoadBottom()?z(b):Q(function(c){b&&b!==K||a.$$destroyed||(c.length<H&&(M.eof=!0),c.length>0&&(N.clipTop(),M.append(c),M.setUpper()),z(b))}):M.length&&!N.shouldLoadTop()?z(b):R(function(c){b&&b!==K||a.$$destroyed||(c.length<H&&(M.bof=!0),c.length>0&&(M.length&&N.clipBottom(),M.prepend(c),M.setLower()),z(b))})}function B(){d.$$phase||O.isLoading||O.disabled||(x(K,!0),L.length?p():(O.calculateProperties(),a.$apply()))}function C(a){if(!O.disabled){var b=N[0].scrollTop,c=N[0].scrollHeight-N[0].clientHeight;(0===b&&!M.bof||b===c&&!M.eof)&&a.preventDefault()}}var D=h.uiScroll.match(/^\s*(\w+)\s+in\s+([\w\.]+)\s*$/);if(!D)throw new Error("Expected uiScroll in form of '_item_ in _datasource_' but got '"+h.uiScroll+"'");var E=null,F=D[1],G=D[2],H=Math.max(3,+h.bufferSize||10),I=i[0],J=parseInt(h.startIndex,10);J=isNaN(J)?1:J;var K=0,L=[],M=new l(H),N=new m(M,b,I,h),O=new n(h,N,M,y);I&&(I.adapter=O);var P=function(){return angular.isObject(E)&&angular.isFunction(E.get)};if(E=g(G)(a),!P()&&(E=c.get(G),!P()))throw new Error(G+" is not a valid datasource");k(E,"minIndex","minIndexUser"),k(E,"maxIndex","maxIndexUser");var Q=2!==E.get.length?function(a){return E.get(M.next,H,a)}:function(a){E.get({index:M.next,append:M.length?M[M.length-1].item:void 0,count:H},a)},R=2!==E.get.length?function(a){return E.get(M.first-H,H,a)}:function(a){E.get({index:M.first-H,prepend:M.length?M[0].item:void 0,count:H},a)};O.reload=q,h.adapter&&g(h.adapter).assign(a,O),j(function(a,b){N.createPaddingElements(a[0]),b.$destroy(),a.remove()}),a.$on("$destroy",function(){p(),N.unbind("mousewheel",C)}),N.bind("mousewheel",C),e(function(){N.applyContainerStyle(),q()})}var p=c.has&&c.has("$animate")?c.get("$animate"):null,q=1===angular.version.major&&angular.version.minor<3;return{require:["?^uiScrollViewport"],transclude:"element",priority:1e3,terminal:!0,link:o}}])}();